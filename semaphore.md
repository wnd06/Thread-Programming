
### semaphore

- dressroom으로 들어 갈 때는 안에 사람이 있는지 없는지 체크할 수 있는 신호가 필요하다. 두 명의 사람이 옷을 갈아 입을 때 하나의 dressroom을 공유한다. 이 때 안에 사람이 있는데 확인 할 방법이 있어야 한다. 그 방법이 신호기(semaphore)가 한다.

```java
Semaphore(int permits)

Semaphore(int permits, boolean fair)
```

- 임계영역, 즉 공유된 dressroom으로 접근하려면 권한(lock)을 얻어야한다.

- 권한을 얻으려면 우선 임계영역이 점유된 상태인지 확인해야한다. 이 때 점유상태 여부를 알려주는 flag역할을 하는 것이 바로 파라미터 값으로 받은 perimits 값이다. 

- 생성자의 파라미터로 받은 값의 의미는 공유자원의 개수라는 의미이다.

- perimits 값을 5라고 생각했을 때 누군가 한 개의 자원을 점유 한다면 perimits값은 4가 될 것이다. 그리고 점유를 끝나고 돌려놓은면 다시 5가 될 것이다. 

- 이제 공유자원에 접근한 스레드는 permits가 0보다 클 경우 자원을 점유할 수 있다. 하지만 0 또는 음수라면 공유자원에 점유 할 공간이 없다는 의미가 되면서, 공유자원에 들어가지 못한 스레드 들은 대기 상태가 된다
	- 이 때 대기 상태에 들어간 스레드들은 List로 된 자료구조에 저장된다. (일종의 대기실)
	- 그리고 스레드 중 하나를 깨운다면 이 때 그 선택 방법은 무작위이다.
	- 그러나 만약 boolean fair 파라미터에 true를 넣어준다면 제일 처음 리스트에 들어갔던 스레드를 실행시킨다.

### semaphore 메소드

#### acquire()
- acquire()는 lock을 확보하는 Operation을 실행하는 메소드이다. 
- acquire()가 호출되면 세마포어는 permits를 검사한다. permits >= 1이면 스레드가 임계영역으로 들어가는 것을 허가해주고, 만약 1보다 작다면 접근한 스레드를 리스트 자료구조에 넣아 저장한 후 대기(일시정지) 시킨다.

#### release()
- release()는 lock을 내려놓는 Operation을 실행하는 메소드이다.
- 이제 임계영역에 Lock을 가지고 있던 하나의 스레드는 활동을 끝내면 perimits 값은 1이 올라간다. 
- 그리고 대기 리스트에서 대기중인 스레드들 중 하나를 깨운다. 
- 깨어난 스레드는 자연스레 임계영역에 들어가게된다.